import { CheckoutTable } from '../types/index';

export const checkoutTable: CheckoutTable = {
  170: [{ score: 170, darts: ['T20', 'T20', 'Bull'], preferred: true }],
  167: [{ score: 167, darts: ['T20', 'T19', 'Bull'], preferred: true }],
  164: [{ score: 164, darts: ['T20', 'T18', 'Bull'], preferred: true }],
  161: [{ score: 161, darts: ['T20', 'T17', 'Bull'], preferred: true }],
  160: [{ score: 160, darts: ['T20', 'T20', 'D20'], preferred: true }],
  158: [{ score: 158, darts: ['T20', 'T20', 'D19'], preferred: true }],
  157: [{ score: 157, darts: ['T20', 'T19', 'D20'], preferred: true }],
  156: [{ score: 156, darts: ['T20', 'T20', 'D18'], preferred: true }],
  155: [{ score: 155, darts: ['T20', 'T19', 'D19'], preferred: true }],
  154: [{ score: 154, darts: ['T20', 'T18', 'D20'], preferred: true }],
  153: [{ score: 153, darts: ['T20', 'T19', 'D18'], preferred: true }],
  152: [{ score: 152, darts: ['T20', 'T20', 'D16'], preferred: true }],
  151: [{ score: 151, darts: ['T20', 'T17', 'D20'], preferred: true }],
  150: [{ score: 150, darts: ['T20', 'T18', 'D18'], preferred: true }],
  149: [{ score: 149, darts: ['T20', 'T19', 'D16'], preferred: true }],
  148: [{ score: 148, darts: ['T20', 'T16', 'D20'], preferred: true }],
  147: [{ score: 147, darts: ['T20', 'T17', 'D18'], preferred: true }],
  146: [{ score: 146, darts: ['T20', 'T18', 'D16'], preferred: true }],
  145: [{ score: 145, darts: ['T20', 'T15', 'D20'], preferred: true }],
  144: [{ score: 144, darts: ['T20', 'T20', 'D12'], preferred: true }],
  143: [{ score: 143, darts: ['T20', 'T17', 'D16'], preferred: true }],
  142: [{ score: 142, darts: ['T20', 'T14', 'D20'], preferred: true }],
  141: [{ score: 141, darts: ['T20', 'T19', 'D12'], preferred: true }],
  140: [{ score: 140, darts: ['T20', 'T20', 'D10'], preferred: true }],
  139: [{ score: 139, darts: ['T19', 'T14', 'D20'], preferred: true }],
  138: [{ score: 138, darts: ['T20', 'T18', 'D12'], preferred: true }],
  137: [{ score: 137, darts: ['T20', 'T15', 'D16'], preferred: true }],
  136: [{ score: 136, darts: ['T20', 'T20', 'D8'], preferred: true }],
  135: [{ score: 135, darts: ['T20', 'T17', 'D12'], preferred: true }],
  134: [{ score: 134, darts: ['T20', 'T14', 'D16'], preferred: true }],
  133: [{ score: 133, darts: ['T20', 'T19', 'D8'], preferred: true }],
  132: [{ score: 132, darts: ['T20', 'T16', 'D12'], preferred: true }],
  131: [{ score: 131, darts: ['T20', 'T13', 'D16'], preferred: true }],
  130: [{ score: 130, darts: ['T20', 'T18', 'D8'], preferred: true }],
  129: [{ score: 129, darts: ['T19', 'T16', 'D12'], preferred: true }],
  128: [{ score: 128, darts: ['T18', 'T14', 'D16'], preferred: true }],
  127: [{ score: 127, darts: ['T20', 'T17', 'D8'], preferred: true }],
  126: [{ score: 126, darts: ['T19', 'T19', 'D6'], preferred: true }],
  125: [{ score: 125, darts: ['25', 'T20', 'D20'], preferred: true }],
  124: [{ score: 124, darts: ['T20', 'T14', 'D11'], preferred: true }],
  123: [{ score: 123, darts: ['T19', 'T16', 'D9'], preferred: true }],
  122: [{ score: 122, darts: ['T18', 'T18', 'D7'], preferred: true }],
  121: [{ score: 121, darts: ['T20', 'T11', 'D14'], preferred: true }],
  120: [{ score: 120, darts: ['T20', 'S20', 'D20'], preferred: true }],
  119: [{ score: 119, darts: ['T19', 'T12', 'D13'], preferred: true }],
  118: [{ score: 118, darts: ['T20', 'S18', 'D20'], preferred: true }],
  117: [{ score: 117, darts: ['T20', 'S17', 'D20'], preferred: true }],
  116: [{ score: 116, darts: ['T20', 'S16', 'D20'], preferred: true }],
  115: [{ score: 115, darts: ['T20', 'S15', 'D20'], preferred: true }],
  114: [{ score: 114, darts: ['T20', 'S14', 'D20'], preferred: true }],
  113: [{ score: 113, darts: ['T20', 'S13', 'D20'], preferred: true }],
  112: [{ score: 112, darts: ['T20', 'S12', 'D20'], preferred: true }],
  111: [{ score: 111, darts: ['T20', 'S19', 'D16'], preferred: true }],
  110: [{ score: 110, darts: ['T20', 'S10', 'D20'], preferred: true }],
  109: [{ score: 109, darts: ['T20', 'S9', 'D20'], preferred: true }],
  108: [{ score: 108, darts: ['T20', 'S16', 'D16'], preferred: true }],
  107: [{ score: 107, darts: ['T19', 'S10', 'D20'], preferred: true }],
  106: [{ score: 106, darts: ['T20', 'S6', 'D20'], preferred: true }],
  105: [{ score: 105, darts: ['T20', 'S13', 'D16'], preferred: true }],
  104: [{ score: 104, darts: ['T18', 'S10', 'D20'], preferred: true }],
  103: [{ score: 103, darts: ['T20', 'S3', 'D20'], preferred: true }],
  102: [{ score: 102, darts: ['T20', 'S10', 'D16'], preferred: true }],
  101: [{ score: 101, darts: ['T20', 'S9', 'D16'], preferred: true }],
  100: [{ score: 100, darts: ['T20', 'D20'], preferred: true }],
  99: [{ score: 99, darts: ['T19', 'S10', 'D16'], preferred: true }],
  98: [{ score: 98, darts: ['T20', 'D19'], preferred: true }],
  97: [{ score: 97, darts: ['T19', 'D20'], preferred: true }],
  96: [{ score: 96, darts: ['T20', 'D18'], preferred: true }],
  95: [{ score: 95, darts: ['T19', 'D19'], preferred: true }],
  94: [{ score: 94, darts: ['T18', 'D20'], preferred: true }],
  93: [{ score: 93, darts: ['T19', 'D18'], preferred: true }],
  92: [{ score: 92, darts: ['T20', 'D16'], preferred: true }],
  91: [{ score: 91, darts: ['T17', 'D20'], preferred: true }],
  90: [{ score: 90, darts: ['T18', 'D18'], preferred: true }],
  89: [{ score: 89, darts: ['T19', 'D16'], preferred: true }],
  88: [{ score: 88, darts: ['T16', 'D20'], preferred: true }],
  87: [{ score: 87, darts: ['T17', 'D18'], preferred: true }],
  86: [{ score: 86, darts: ['T18', 'D16'], preferred: true }],
  85: [{ score: 85, darts: ['T15', 'D20'], preferred: true }],
  84: [{ score: 84, darts: ['T20', 'D12'], preferred: true }],
  83: [{ score: 83, darts: ['T17', 'D16'], preferred: true }],
  82: [{ score: 82, darts: ['T14', 'D20'], preferred: true }],
  81: [{ score: 81, darts: ['T19', 'D12'], preferred: true }],
  80: [{ score: 80, darts: ['T20', 'D10'], preferred: true }],
  79: [{ score: 79, darts: ['T13', 'D20'], preferred: true }],
  78: [{ score: 78, darts: ['T18', 'D12'], preferred: true }],
  77: [{ score: 77, darts: ['T15', 'D16'], preferred: true }],
  76: [{ score: 76, darts: ['T20', 'D8'], preferred: true }],
  75: [{ score: 75, darts: ['T17', 'D12'], preferred: true }],
  74: [{ score: 74, darts: ['T14', 'D16'], preferred: true }],
  73: [{ score: 73, darts: ['T19', 'D8'], preferred: true }],
  72: [{ score: 72, darts: ['T16', 'D12'], preferred: true }],
  71: [{ score: 71, darts: ['T13', 'D16'], preferred: true }],
  70: [{ score: 70, darts: ['T18', 'D8'], preferred: true }],
  69: [{ score: 69, darts: ['T19', 'D6'], preferred: true }],
  68: [{ score: 68, darts: ['T20', 'D4'], preferred: true }],
  67: [{ score: 67, darts: ['T17', 'D8'], preferred: true }],
  66: [{ score: 66, darts: ['T10', 'D18'], preferred: true }],
  65: [{ score: 65, darts: ['T19', 'D4'], preferred: true }],
  64: [{ score: 64, darts: ['T16', 'D8'], preferred: true }],
  63: [{ score: 63, darts: ['T13', 'D12'], preferred: true }],
  62: [{ score: 62, darts: ['T10', 'D16'], preferred: true }],
  61: [{ score: 61, darts: ['T15', 'D8'], preferred: true }],
  60: [{ score: 60, darts: ['S20', 'D20'], preferred: true }],
  59: [{ score: 59, darts: ['S19', 'D20'], preferred: true }],
  58: [{ score: 58, darts: ['S18', 'D20'], preferred: true }],
  57: [{ score: 57, darts: ['S17', 'D20'], preferred: true }],
  56: [{ score: 56, darts: ['T16', 'D4'], preferred: true }],
  55: [{ score: 55, darts: ['S15', 'D20'], preferred: true }],
  54: [{ score: 54, darts: ['S14', 'D20'], preferred: true }],
  53: [{ score: 53, darts: ['S13', 'D20'], preferred: true }],
  52: [{ score: 52, darts: ['S12', 'D20'], preferred: true }],
  51: [{ score: 51, darts: ['S11', 'D20'], preferred: true }],
  50: [{ score: 50, darts: ['S10', 'D20'], preferred: true }],
  49: [{ score: 49, darts: ['S9', 'D20'], preferred: true }],
  48: [{ score: 48, darts: ['S16', 'D16'], preferred: true }],
  47: [{ score: 47, darts: ['S15', 'D16'], preferred: true }],
  46: [{ score: 46, darts: ['S6', 'D20'], preferred: true }],
  45: [{ score: 45, darts: ['S13', 'D16'], preferred: true }],
  44: [{ score: 44, darts: ['S12', 'D16'], preferred: true }],
  43: [{ score: 43, darts: ['S3', 'D20'], preferred: true }],
  42: [{ score: 42, darts: ['S10', 'D16'], preferred: true }],
  41: [{ score: 41, darts: ['S9', 'D16'], preferred: true }],
  40: [{ score: 40, darts: ['D20'], preferred: true }],
  39: [{ score: 39, darts: ['S7', 'D16'], preferred: true }],
  38: [{ score: 38, darts: ['D19'], preferred: true }],
  37: [{ score: 37, darts: ['S5', 'D16'], preferred: true }],
  36: [{ score: 36, darts: ['D18'], preferred: true }],
  35: [{ score: 35, darts: ['S3', 'D16'], preferred: true }],
  34: [{ score: 34, darts: ['D17'], preferred: true }],
  33: [{ score: 33, darts: ['S1', 'D16'], preferred: true }],
  32: [{ score: 32, darts: ['D16'], preferred: true }],
  31: [{ score: 31, darts: ['S15', 'D8'], preferred: true }],
  30: [{ score: 30, darts: ['D15'], preferred: true }],
  29: [{ score: 29, darts: ['S13', 'D8'], preferred: true }],
  28: [{ score: 28, darts: ['D14'], preferred: true }],
  27: [{ score: 27, darts: ['S11', 'D8'], preferred: true }],
  26: [{ score: 26, darts: ['D13'], preferred: true }],
  25: [{ score: 25, darts: ['S9', 'D8'], preferred: true }],
  24: [{ score: 24, darts: ['D12'], preferred: true }],
  23: [{ score: 23, darts: ['S7', 'D8'], preferred: true }],
  22: [{ score: 22, darts: ['D11'], preferred: true }],
  21: [{ score: 21, darts: ['S5', 'D8'], preferred: true }],
  20: [{ score: 20, darts: ['D10'], preferred: true }],
  19: [{ score: 19, darts: ['S3', 'D8'], preferred: true }],
  18: [{ score: 18, darts: ['D9'], preferred: true }],
  17: [{ score: 17, darts: ['S1', 'D8'], preferred: true }],
  16: [{ score: 16, darts: ['D8'], preferred: true }],
  15: [{ score: 15, darts: ['S7', 'D4'], preferred: true }],
  14: [{ score: 14, darts: ['D7'], preferred: true }],
  13: [{ score: 13, darts: ['S5', 'D4'], preferred: true }],
  12: [{ score: 12, darts: ['D6'], preferred: true }],
  11: [{ score: 11, darts: ['S3', 'D4'], preferred: true }],
  10: [{ score: 10, darts: ['D5'], preferred: true }],
  9: [{ score: 9, darts: ['S1', 'D4'], preferred: true }],
  8: [{ score: 8, darts: ['D4'], preferred: true }],
  7: [{ score: 7, darts: ['S3', 'D2'], preferred: true }],
  6: [{ score: 6, darts: ['D3'], preferred: true }],
  5: [{ score: 5, darts: ['S1', 'D2'], preferred: true }],
  4: [{ score: 4, darts: ['D2'], preferred: true }],
  3: [{ score: 3, darts: ['S1', 'D1'], preferred: true }],
  2: [{ score: 2, darts: ['D1'], preferred: true }],
};

export const getCheckoutSuggestion = (score: number, dartsRemaining: number = 3): string[] | null => {
  if (score > 170 || score < 2 || score === 169 || score === 168 || score === 166 || score === 165 || score === 163 || score === 162 || score === 159) {
    return null;
  }

  const routes = checkoutTable[score];
  if (!routes || routes.length === 0) return null;

  const preferredRoute = routes.find(r => r.preferred) || routes[0];
  
  if (dartsRemaining < preferredRoute.darts.length) {
    return null;
  }

  return preferredRoute.darts.slice(0, dartsRemaining);
};

export const isCheckoutPossible = (score: number, dartsRemaining: number = 3): boolean => {
  return getCheckoutSuggestion(score, dartsRemaining) !== null;
};

export const getBogeyNumbers = (): number[] => {
  return [169, 168, 166, 165, 163, 162, 159];
};